\begin{frame}
   \frametitle{8.3 Segurança = Progresso + Preservação}
   \begin{itemize}
      \item Garantias que a avaliação de um programa bem tipado não travará.
      \item Dois pilares da segurança:
      \begin{itemize}
         \item [$\checkmark$] \textbf{Progresso:} termos bem tipados são avaliados completamente (até sua forma normal).
         \item [$\checkmark$] \textbf{Preservação:} um passo de avaliação de um termo bem tipado resulta noutro termo igualmente bem tipado.
      \end{itemize}
      \item No decorrer do Capítulo 8.3, \cite{pierce} mostra exemplos de Progresso e Conservação, onde os termos são classificados em alguma regra de inferência (como \textsc{T-True, T-If} e \textsc{T-Succ}) e é aplicada alguma regra de avaliação a ele (\textsc{E-IfTrue, E-If, E-Succ, }\ldots).
   \end{itemize}
\end{frame}

\begin{frame}
   \frametitle{8.3.1 Formas Canônicas}
   \footnotesize
   \begin{lemma}[\textsc{Formas Canônicas} \texttt{I}]
      Se \texttt{v} é um valor do tipo \texttt{Bool} então v é \texttt{true} ou
      \texttt{false}.
      \begin{align*}
         \text{t} \qquad & ::= & &\\
         & \text{\texttt{true}} & \text{valor ``verdadeiro''}\\
         & \text{\texttt{false}} & \text{valor ``falso''}\\
      \end{align*}
   \end{lemma}
   \begin{lemma}[\textsc{Formas Canônicas} \texttt{II}]
      Se \texttt{v} é um valor do tipo \texttt{Nat} então v é um valor numérico
      conforme a gramática:
      \begin{align*}
         \text{v} \qquad & ::= \ldots & \\
         & \text{nv} & \text{valor numérico}\\
         \text{nv} \qquad & ::= & \\
         & \text{\texttt{0}} & \text{valor ``zero''}\\
         & \text{\texttt{succ nv}} & \text{sucessor}
      \end{align*}
   \end{lemma}
\end{frame}

\begin{frame}
   \frametitle{8.2.1 Inversão da Relação de Tipos}
   \begin{lemma}[Inversão da Relação de Tipos]
      \begin{enumerate}
         \item Se \texttt{\frenchspacing true : R}, então \texttt{R = Bool}. \label{invtipos:true}
         \item Se \texttt{\frenchspacing false : R}, então \texttt{R = Bool}. \label{invtipos:false}
         \item Se \texttt{\frenchspacing if t$_1$ then t$_2$ else t$_3$ : R}, então \texttt{\frenchspacing t$_1$ : Bool},
            \texttt{\frenchspacing t$_2$ : R}, e \texttt{\frenchspacing t$_3$ : R}.
         \item Se \texttt{\frenchspacing 0 : R}, então \texttt{\frenchspacing R = Nat}. \label{invtipos:zero}
         \item Se \texttt{\frenchspacing succ t$_1$ : R}, então \texttt{R = Nat} e \texttt{\frenchspacing t$_1$ : Nat}.
         \item Se \texttt{\frenchspacing pred t$_1$ : R}, então \texttt{R = Nat} e \texttt{\frenchspacing t$_1$ : Nat}.
         \item Se \texttt{\frenchspacing iszero t$_1$ : R}, então \texttt{R = Bool} e \texttt{\frenchspacing t$_1$ : Nat}.
      \end{enumerate}
   \end{lemma}
   \textbf{Prova: } Imediato a partir das Formas Canônicas.
\end{frame}

\begin{frame}
   \frametitle{8.3.2 Teorema: Progresso}
   \begin{block}{}
      Suponha \texttt{t} um termo bem tipado. Então ou \texttt{t} é um valor ou ele será avaliado (\texttt{t} $\rightarrow$ \texttt{t'}).
   \end{block}
   \begin{itemize}
      \item Por indução, \textsc{T-True}, \textsc{T-False} e \textsc{T-Zero} são casos diretos: itens \ref{invtipos:true}, \ref{invtipos:zero} e
         \ref{invtipos:false} do Lema de Relação de Tipos, respectivamente.
      \item \texttt{T-If}:
      \begin{align*}
         & \texttt{t} = \mbox{\texttt{if t$_1$ then t$_2$ else t$_3$}}\\
         & \mbox{\frenchspacing \texttt{t$_1$ : Bool \qquad t$_2$ : T \quad t$_3$ : T}}
      \end{align*}
      \begin{itemize}
         \item [$\checkmark$] Se a guarda do \texttt{if} é um valor então ele será
         \texttt{true} ou \texttt{false} -- conforme as Formas Canônicas -- e uma das seguintes regras serão aplicadas: \texttt{E-IfTrue} ou \texttt{E-IfFalse}.
         \item [$\checkmark$] Senão \texttt{t} $\rightarrow$ \texttt{t'} e aplica-se \texttt{T-If}:
         \begin{align*}
            & \texttt{t} = \mbox{\texttt{if t$_1$' then t$_2$ else t$_3$}}
         \end{align*}
      \end{itemize}
   \end{itemize}
\end{frame}

\begin{frame}
   \frametitle{8.3.2 Teorema: Progresso}
   \begin{block}{}
      Suponha \texttt{t} um termo bem tipado. Então ou \texttt{t} é um valor ou ele será avaliado (\texttt{t} $\rightarrow$ \texttt{t'}).
   \end{block}
   \begin{itemize}
      \item \texttt{T-Succ}:
      \begin{align*}
         & \texttt{t} = \mbox{\texttt{succ t$_1$ \qquad t$_1$ : Nat}}
      \end{align*}
      \begin{itemize}
         \item [$\checkmark$] Se \texttt{t$_1$} for um valor, então ele é do tipo numérico (\texttt{Nat}) e, segundo as Formas Canônicas, avalia para \texttt{0} ou \texttt{succ nv}
         \item [$\checkmark$] Senão \texttt{t} $\rightarrow$ \texttt{t'} e aplica-se \textsc{E-Succ}:
      \end{itemize}
   \end{itemize}
   \begin{align*}
      & \mbox{t = \texttt{succ t$_1$'}}
   \end{align*}
\end{frame}

\begin{frame}
   \frametitle{8.3.2 Teorema: Progresso}
   \begin{block}{}
      Suponha \texttt{t} um termo bem tipado. Então ou \texttt{t} é um valor ou ele será avaliado (\texttt{t} $\rightarrow$ \texttt{t'}).
   \end{block}
   \begin{itemize}
      \item \texttt{T-Pred}:
      \begin{align*}
         & \texttt{t} = \mbox{\texttt{pred t$_1$ \qquad t$_1$: Nat}}
      \end{align*}
      \begin{itemize}
         \item [$\checkmark$] Se \texttt{t$_1$} for um valor, então ele é do tipo numérico (\texttt{Nat}) e pode ser avaliado por uma das seguintes regras:
         \textsc{E-PredZero} ou \textsc{E-PredSucc}
         \item [$\checkmark$] Senão \texttt{t} $\rightarrow$ \texttt{t'} e aplica-se \textsc{E-Pred}
         \begin{align*}
            & \mbox{\texttt{pred t$_1$'}}
         \end{align*}
      \end{itemize}
   \end{itemize}
\end{frame}

\begin{frame}
   \frametitle{8.3.2 Teorema: Progresso}
   \begin{block}{}
      Suponha \texttt{t} um termo bem tipado. Então ou \texttt{t} é um valor ou ele será avaliado (\texttt{t} $\rightarrow$ \texttt{t'}).
   \end{block}
   \begin{itemize}
      \item \texttt{T-IsZero}:
      \begin{align*}
         & \texttt{t} = \mbox{\texttt{iszero t$_1$ \qquad t$_1$: Nat}}
      \end{align*}
      \begin{itemize}
         \item [$\checkmark$] Mesmas condições de \textsc{T-Pred} com a ressalva
         de que as regras aplicáveis a \texttt{t} são \textsc{E-IszeroZero}, \textsc{E-IszeroSucc} e \textsc{E-IsZero}
      \end{itemize}
   \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{8.3.3 Teorema: Preservação}
   \begin{block}{}
      \begin{minipage}{1\textwidth}
      \begin{center}
         Suponha \texttt{\frenchspacing t : T} \quad e \quad \texttt{t} $\rightarrow$ \texttt{t'}. Então \texttt{\frenchspacing t' : T}.
         \end{center}
      \end{minipage}
   \end{block}
   \begin{itemize}
      \item \textsc{T-True, T-False} e \textsc{T-Zero}:
         \begin{itemize}
            \item [$\checkmark$] \texttt{t} é um valor e o teorema não se aplica.
         \end{itemize}
      \item \texttt{T-If}:
      \begin{align*}
         & \texttt{t} = \mbox{\texttt{if t$_1$ then t$_2$ else t$_3$}}\\
         & \mbox{\frenchspacing \texttt{t$_1$ : Bool \qquad t$_2$ : T \quad t$_3$ : T}}
      \end{align*}
      \begin{itemize}
         \item [$\checkmark$] Caso \texttt{\frenchspacing t$_1$ : Bool}: Aplica-se \textsc{E-IfTrue} ou \textsc{E-IfFalse}.
         \item [$\checkmark$] Se \texttt{t$_1$} não é um valor, \texttt{t$_1$ $\rightarrow$ t$_1$'} e então aplica-se \textsc{E-If}
         \begin{align*}
         & \texttt{t'} = \mbox{\texttt{if t$_1$' then t$_2$ else t$_3$}}\\
         & \mbox{\frenchspacing \texttt{t$_1$' : Bool \qquad t$_2$ : T \quad t$_3$ : T}}
      \end{align*}
      \end{itemize}
   \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{8.3.3 Teorema: Preservação}
   \begin{block}{}
      \begin{minipage}{1\textwidth}
      \begin{center}
         Suponha \texttt{\frenchspacing t : T} \quad e \quad \texttt{t} $\rightarrow$ \texttt{t'}. Então \texttt{\frenchspacing t' : T}.
         \end{center}
      \end{minipage}
   \end{block}
   \begin{itemize}
      \item \textsc{T-Succ}:
      \begin{align*}
         & \texttt{t} = \mbox{\texttt{\frenchspacing succ t$_1$ \quad T = Nat \quad t$_1$ : Nat}}
      \end{align*}
      \begin{itemize}
         \item [$\checkmark$] Só é possível avaliar via \textsc{E-Succ}:\\
      \end{itemize}
   \end{itemize}
   \begin{center}
      \begin{minipage}{0pt}
      \infer[\textsc{(E-Succ)}]{\texttt{succ t$_1$ $\rightarrow$ succ t$_1$1}}{\texttt{t$_1$ $\rightarrow$ t$_1$'}}
      \end{minipage}
      \end{center}
\end{frame}
